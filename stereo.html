<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Three.js Device Orientation Example</title>
    <script src="https://threejs.org/build/three.js"></script>
  </head>
  <body>
    <button id="startButton">Start</button>
    <script>
      var startButton = document.getElementById('startButton');
      startButton.addEventListener('click', init);

      var scene, camera, renderer, cube;

      function init() {
        // Check for orientation support and request permission
        if ('DeviceOrientationEvent' in window && typeof DeviceOrientationEvent.requestPermission === 'function') {
          DeviceOrientationEvent.requestPermission()
            .then(permissionState => {
              if (permissionState === 'granted') {
                window.addEventListener('deviceorientation', handleOrientation);
              } else {
                alert('Permission not granted.');
              }
            })
            .catch(console.error);
        } else {
          // Automatically start if no permission is required
          window.addEventListener('deviceorientation', handleOrientation);
        }

        // Three.js initialization code here
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        var geometry = new THREE.BoxGeometry(1, 1, 1);
        var material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
        cube = new THREE.Mesh(geometry, material);
        scene.add(cube);

        camera.position.z = 5;

        animate();
      }

      function handleOrientation(event) {
        var alpha = event.alpha;
        var beta = event.beta;
        var gamma = event.gamma;

        if (camera) {
          camera.rotation.x = THREE.Math.degToRad(beta);
          camera.rotation.y = THREE.Math.degToRad(alpha);
          camera.rotation.z = THREE.Math.degToRad(gamma);
        }
      }

      function animate() {
        requestAnimationFrame(animate);
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
