<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>
    <!-- Modal -->
    <div id="permissionModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; align-items: center; justify-content: center;">
      <div style="background: white; padding: 20px;">
        <p>Bitte erlauben Sie den Zugriff auf die Geräteausrichtung.</p>
        <button id="requestPermissionButton">Erlauben</button>
      </div>
    </div>
    <!-- A-Frame Scene -->
     <a-scene device-orientation-permission-ui="enabled: false">
      <a-entity id="cameraRig">
        <a-camera></a-camera>
      </a-entity>
      <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene>

    <script>
      let cameraRig = document.getElementById('cameraRig');
      let permissionModal = document.getElementById('permissionModal');
      let requestPermissionButton = document.getElementById('requestPermissionButton');

      // Funktion, um die Erlaubnis für die Geräteausrichtung zu überprüfen und anzufordern
      async function requestOrientationPermission() {
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
          try {
            const permissionState = await DeviceOrientationEvent.requestPermission();
            if (permissionState === 'granted') {
              permissionModal.style.display = 'none';
              // ... (Eventlistener für deviceorientationabsolute hinzufügen, siehe vorheriges Beispiel) ...
            }
          } catch (error) {
            console.error('Permission error:', error);
          }
        }
      }

      // Wenn das Gerät iOS ist oder die requestPermission-Methode vorhanden ist, Modal anzeigen
      if (/iPhone|iPad|iPod|iOS/i.test(navigator.userAgent) || typeof DeviceOrientationEvent.requestPermission === 'function') {
        permissionModal.style.display = 'flex';
      }

      // Button-Eventlistener
      requestPermissionButton.addEventListener('click', requestOrientationPermission);
    </script>
  </body>
</html>
