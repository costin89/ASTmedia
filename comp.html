<!DOCTYPE html>
<html>
<head>
  <title>Kompass App</title>
  <style>
    #kompass {
      width: 200px;
      height: 200px;
      border: 10px solid #000;
      border-radius: 50%;
      position: relative;
    }
    #nadel {
      width: 10px;
      height: 100px;
      background-color: red;
      position: absolute;
      top: 50%;
      left: 50%;
      transform-origin: 50% 0%;
    }
  </style>
</head>
<body>
  <button onclick="initOrientation()">Berechtigung anfordern und Kompass starten</button>
  <div id="kompass">
    <div id="nadel"></div>
  </div>
  <script>
    function initOrientation() {
      if (typeof DeviceOrientationEvent.requestPermission === 'function') {
        DeviceOrientationEvent.requestPermission()
          .then(permissionState => {
            if (permissionState === 'granted') {
              window.addEventListener('deviceorientationabsolute', updateCompass);
            } else {
              alert('Berechtigung abgelehnt.');
            }
          })
          .catch(console.error);
      } else {
        // handle regular non iOS 13+ devices
        window.addEventListener('deviceorientationabsolute', updateCompass);
      }
    }

    function updateCompass(event) {
      if (event.absolute) {
        var alpha = event.alpha;
        var nadel = document.getElementById("nadel");
        nadel.style.transform = `rotate(${alpha}deg)`;
      } else {
        console.log("Die Ausrichtung ist nicht absolut!");
      }
    }
  </script>
</body>
</html>
