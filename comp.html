<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Device Orientation und Geolocation</title>
</head>
<body>
  <button id="startBtn">Start</button>
  <label id="output">Warten...</label>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
  const outputLabel = document.getElementById("output");

  const startBtn = document.getElementById("startBtn");
  startBtn.addEventListener("click", async () => {
    try {
      // Permission für Device Orientation erfragen
      const deviceOrientationPermission = await DeviceOrientationEvent.requestPermission();
      if (deviceOrientationPermission !== 'granted') {
        throw new Error("Device Orientation Permission not granted");
      }

      // Permission für Geolocation erfragen
      const geoPermission = await new Promise((resolve) => {
        navigator.permissions.query({ name: 'geolocation' }).then(result => {
          resolve(result.state);
        });
      });

      if (geoPermission !== 'granted') {
        throw new Error("Geolocation Permission not granted");
      }

      // Device Orientation abfragen
      let alpha = 0;
      window.addEventListener("deviceorientation", (event) => {
        alpha = event.alpha;
        update();
      });

      // Geolocation abfragen
      let latitude = 0;
      let longitude = 0;
      navigator.geolocation.watchPosition((position) => {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
        update();
      });

      // Ausrichtung berechnen und Label updaten
      function update() {
        const computedValue = `Alpha: ${alpha}, Latitude: ${latitude}, Longitude: ${longitude}`;
        outputLabel.textContent = computedValue;
      }
    } catch (error) {
      outputLabel.textContent = error.message;
    }
  });
});

  </script>
</body>
</html>
